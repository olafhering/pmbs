# SLE-11-SP2 has -x86/-32bit versions
%if 0%{?sles_version} == 11 
Prefer: popt
Prefer: liblzma5
Prefer: libtheora0
Prefer: librcc0
Prefer: librcd0
Prefer: libvpx0
Prefer: libavcodec54
Prefer: libfaad2
Prefer: libswscale2
Prefer: libx264-125
Prefer: libmp3lame0
Prefer: libva1
Prefer: libcdda_interface0
Prefer: fribidi
Prefer: liblash1
Prefer: libgstreamer-0_10-0
Prefer: libvpx1
Prefer: libtwolame0
Substitute: gcc46 gcc47
%endif

%if 0%{?suse_version} == 1110
Substitute: gcc46 gcc47
%endif

# %arm seems to be missing armv6l/armv6hl
%define arm %arm armv6l armv6hl

%ifarch armv6l armv6hl
# swkj11.site KVM worker is broken with QEMU armv6 builds, so only use chroot workers for armv6
#Constraint: sandbox chroot
# chroot workers do not need kernel-obs-build, only KVM workers. Do not install it to speed up the build (install time)
#VMinstall: !kernel-obs-build
VMinstall: kernel-obs-build
VMInstall: kernel-obs-build
%endif

# Avoid armv7 build error: "getbinaries: missing packages: kernel-obs-build"
%ifarch armv7l armv7hl
VMinstall: !kernel-obs-build
VMInstall: !kernel-obs-build
%endif

#AArch64 and armv6 are built using QEMU
%ifarch aarch64 armv6l armv6hl
%define qemu_user_space_build 1
%endif

%if "%qemu_user_space_build" == "1"
# Reenable armv6l build only on QEMU_ARM workers
Constraint: hostlabel QEMU_ARM
Macros:
%qemu_user_space_build 1
%_without_mono 1
:Macros
%endif

%ifarch armv6l armv6hl
# Prefer raspberry pi openGL ES libs (built from sources) instead of Mesa openGL ES libs (and pre-built libs)
#Prefer: raspberrypi-gfx raspberrypi-gfx-devel
Prefer: raspberrypi-userland raspberrypi-userland-devel
Prefer: -Mesa-libEGL1 -Mesa-libEGL-devel
# omxplayer also provides ffmpeg libs, so prefer to use ffmpeg ones
Prefer: -omxplayer
%endif

# Because of pkgconfig() type BuildRequires
Prefer: -libffmpeg_oldabi-devel
Prefer: -libffmpeg1-devel

%if 0%{?suse_version} < 1220
Support: xz
# Because there are too many packages that need to update its BuildRequires
Substitute: mjpegtools-devel libmjpegutils-devel=
# Because pkgconfig() style BuildRequires
Prefer: -libcdio-mini-devel
%if 0%{?suse_version} < 1210
# Because Packman provides it own version and there was a rename
Prefer: -libquicktime
%endif
%endif


# The XUL thing...
%if 0%{?suse_version} == 1210
Prefer: xulrunner-devel
%endif
%if 0%{?suse_version} == 1140
Substitute: pkgconfig(npapi-sdk) mozilla-xulrunner20-devel=
%endif
%if 0%{?suse_version} <= 1120
Substitute: pkgconfig(npapi-sdk) mozilla-xulrunner192-devel=
%endif

Prefer: liborc-0_4-0

# Support pkgconfig() BuildRequires in old distros
%if 0%{?suse_version} <= 1210
Substitute: libxml2-tools libxml2=
Substitute: pkgconfig(expat) libexpat-devel=
Substitute: pkgconfig(glu) Mesa-devel=
Substitute: pkgconfig(libxslt) libxslt-devel=
Substitute: pkgconfig(ogg) libogg-devel=
Substitute: pkgconfig(opus) opus-devel=
Substitute: pkgconfig(opusfile) opusfile-devel=
Substitute: pkgconfig(yelp-xsl) yelp-xsl=
%if 0%{?suse_version} <= 1140
Substitute: pkgconfig(id3tag) libid3tag-devel=
Substitute: pkgconfig(libavcodec) libffmpeg-devel=
Substitute: pkgconfig(libavdevice) libffmpeg-devel=
Substitute: pkgconfig(libavformat) libffmpeg-devel=
Substitute: pkgconfig(libavutil) libffmpeg-devel=
Substitute: pkgconfig(libpostproc) libffmpeg-devel=
Substitute: pkgconfig(libswresample) libffmpeg-devel=
Substitute: pkgconfig(libswscale) libffmpeg-devel=
Substitute: pkgconfig(libvlc) vlc-devel=
Substitute: pkgconfig(libxml++) libxml++-devel=
Substitute: pkgconfig(soundtouch) soundtouch-devel=
Substitute: pkgconfig(taglib) libtag-devel=
Substitute: pkgconfig(taglib_c) libtag-devel=
%if 0%{?suse_version} <= 1120
Substitute: libSDL-devel SDL-devel=
Substitute: libSDL_mixer-devel SDL_mixer-devel=
Substitute: pkgconfig(alsa) alsa-devel=
Substitute: pkgconfig(cairo) cairo-devel=
Substitute: pkgconfig(dbus-1) dbus-1-devel=
Substitute: pkgconfig(dirac) dirac-devel=
Substitute: pkgconfig(enca) enca-devel=
Substitute: pkgconfig(fluidsynth) fluidsynth-devel=
Substitute: pkgconfig(fontconfig) fontconfig-devel=
Substitute: pkgconfig(freetype2) freetype2-devel
Substitute: pkgconfig(frei0r) frei0r-plugins-devel=
Substitute: pkgconfig(fribidi) fribidi-devel=
Substitute: pkgconfig(gdk-2.0) gtk2-devel=
Substitute: pkgconfig(gdk-pixbuf-2.0) gdk-pixbuf-devel=
Substitute: pkgconfig(gdk-x11-2.0) gtk2-devel=
Substitute: pkgconfig(gconf-2.0) gconf2-devel=
Substitute: pkgconfig(gio-2.0) glib2-devel=
Substitute: pkgconfig(glib-2.0) glib2-devel=
Substitute: pkgconfig(gl) Mesa-devel=
Substitute: pkgconfig(gobject-2.0) glib2-devel=
Substitute: pkgconfig(gstreamer-0.10) gstreamer-0_10-devel=
Substitute: pkgconfig(gstreamer-base-0.10) gstreamer-0_10-devel=
Substitute: pkgconfig(gstreamer-controller-0.10) gstreamer-0_10-devel=
Substitute: pkgconfig(gstreamer-plugins-base-0.10) gstreamer-0_10-plugins-base-devel=
Substitute: pkgconfig(gthread-2.0) glib2-devel=
Substitute: pkgconfig(gtkglext-1.0) gtkglext-devel=
Substitute: pkgconfig(gtk+-2.0) gtk2-devel=
# At the very least gmtk benefits from this
Substitute: pkgconfig(gtk+-3.0) gtk2-devel=
Substitute: pkgconfig(gtk+-x11-2.0) gtk2-devel=
Substitute: pkgconfig(jack) libjack-devel=
Substitute: pkgconfig(hunspell) hunspell-devel=
Substitute: pkgconfig(libagg) agg-devel=
Substitute: pkgconfig(libass) libass-devel=
Substitute: pkgconfig(libbml) libbml-devel=
Substitute: pkgconfig(libcurl) libcurl-devel=
Substitute: pkgconfig(libdrm_intel) libdrm-devel=
Substitute: pkgconfig(libdrm) libdrm-devel=
Substitute: pkgconfig(libdv) libdv-devel=
Substitute: pkgconfig(libgme) libgme-devel=
Substitute: pkgconfig(libguess) libguess-devel=
Substitute: pkgconfig(liboil-0.3) liboil-devel=
Substitute: pkgconfig(libpng14) libpng14-devel=
Substitute: pkgconfig(libpng) libpng-devel=
Substitute: pkgconfig(libprojectM) libprojectM-devel=
Substitute: pkgconfig(libprojectM-qt) libprojectM-qt-devel=
Substitute: pkgconfig(libpulse) libpulse-devel=
Substitute: pkgconfig(libpulse-mainloop-glib) libpulse-devel=
Substitute: pkgconfig(libquicktime) libquicktime-devel=
Substitute: pkgconfig(librcd) librcd-devel=
Substitute: pkgconfig(librtmp) librtmp-devel=
Substitute: pkgconfig(libudev) libudev-devel=
Substitute: pkgconfig(libva) libva-devel=
Substitute: pkgconfig(libxml-2.0) libxml2-devel=
Substitute: pkgconfig(lua) lua-devel=
Substitute: pkgconfig(openal) openal-devel=
Substitute: pkgconfig(orc-0.4) orc-devel=
Substitute: pkgconfig(pango) pango-devel=
Substitute: pkgconfig(pangoft2) pango-devel=
Substitute: pkgconfig(QtCore) libqt4-devel=
Substitute: pkgconfig(QtGui) libqt4-devel=
Substitute: pkgconfig(QtSvg) libqt4-devel=
Substitute: pkgconfig(QtXml) libqt4-devel=
Substitute: pkgconfig(samplerate) libsamplerate-devel=
Substitute: pkgconfig(SDL_gfx) SDL_gfx-devel=
Substitute: pkgconfig(sdl) SDL-devel=
Substitute: pkgconfig(sndfile) libsndfile-devel=
Substitute: pkgconfig(sox) sox-devel=
Substitute: pkgconfig(speex) speex-devel=
Substitute: pkgconfig(speexdsp) speex-devel=
Substitute: pkgconfig(tsmux) libtsmux-devel=
Substitute: pkgconfig(vdpau) libvdpau-devel=
Substitute: pkgconfig(vorbisfile) libvorbis-devel=
Substitute: pkgconfig(vo-aacenc) libvo-aacenc-devel=
Substitute: pkgconfig(x11) xorg-x11-libX11-devel=
Substitute: pkgconfig(xext) xorg-x11-libXext-devel=
Substitute: pkgconfig(xfixes) xorg-x11-libXfixes-devel=
Substitute: pkgconfig(xaw7) xorg-x11-devel=
Substitute: pkgconfig(xi) xorg-x11-devel=
Substitute: pkgconfig(xmu) xorg-x11-libXmu-devel=
Substitute: pkgconfig(xt) xorg-x11-devel=
Substitute: pkgconfig(xv) xorg-x11-devel=
Substitute: pkgconfig(zlib) zlib-devel=
%endif
%endif
%endif

Support:    build-compare

%define _without_distributable 1
%define _without_onlynondistributable 1
%define _with_pulseaudio 1
%define _with_sdl 1
%define _with_aalib 1
%define _with_esd 1
%define _with_jack 1
%define _with_gnome_vfs 1
%define _with_directfb 1
%define _with_modplug 1
%define BUILD_ORIG 1
%define BUILD_ORIG_ADDON 1
%define _with_gamin 1
%define _with_cunit 1
%define _with_restricted 1
%define _with_libsidplay 1
%define _with_gme 1
%define _with_jbigkit 1
%define _with_ffmpeg 1
%define _with_mad 1
%define _with_lame 1
%define _with_twolame 1
%define _with_amrwb 1
%define _with_amrnb 1
%define _with_libmms 1
# Needed because of gstreamer-0_10-plugins-bad. Should dissapear in the future, once slv2 and lv2core 
# are in openSUSE.
%define _with_LV2 1
%define _with_mpg123 1
%define _with_faad 1


Macros:
%vendor http://packman.links2linux.de
%packager packman@links2linux.de
%packman_bs 1
%_without_distributable 1
%_without_onlynondistributable 1
%_with_pulseaudio 1
%_with_sdl 1
%_with_aalib 1
%_with_esd 1
%_with_jack 1
%_with_gnome_vfs 1
%_with_directfb 1
%_with_modplug 1
%BUILD_ORIG 1
%BUILD_ORIG_ADDON 1
%_with_gamin 1
%_with_cunit 1
%_with_restricted 1
%_with_libsidplay 1
%_with_gme 1
%_with_jbigkit 1
%_with_ffmpeg 1
%_with_mad 1
%_with_lame 1
%_with_twolame 1
%_with_amrwb 1
%_with amrnb 1
%_with_libmms 1
%_with_LV2 1
%_with_mpg123 1
%_with_faad 1
